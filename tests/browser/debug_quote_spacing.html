<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Debug Quote Spacing Issue</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { border: 1px solid #ddd; padding: 10px; margin: 10px 0; }
        .result { background: #f0f0f0; padding: 5px; margin: 5px 0; font-family: monospace; }
        button { margin: 5px; }
    </style>
</head>
<body>
    <h1>Debug Quote Spacing</h1>
    
    <div class="test">
        <h3>Test Case: 前面的文字"<span>中间的内容</span>"后面的文字</h3>
        <div id="test1">前面的文字"<span>中间的内容</span>"后面的文字</div>
        <button onclick="applySpacing('test1')">Apply Spacing</button>
        <button onclick="analyzeNodes('test1')">Analyze Nodes</button>
        <div id="result1" class="result"></div>
    </div>

    <div class="test">
        <h3>Test String Processing</h3>
        <button onclick="testString()">Test String Spacing</button>
        <div id="stringResult" class="result"></div>
    </div>

    <script src="../../dist/browser/pangu.umd.js"></script>
    <script>
        function applySpacing(id) {
            const element = document.getElementById(id);
            const before = element.textContent;
            window.pangu.spacingNode(element);
            const after = element.textContent;
            
            const result = document.getElementById('result' + id.slice(-1));
            result.innerHTML = `
Before: "${before}"
After:  "${after}"
Expected: "前面的文字 "中间的内容" 后面的文字"
            `;
        }
        
        function analyzeNodes(id) {
            const element = document.getElementById(id);
            const result = document.getElementById('result' + id.slice(-1));
            let output = 'Node Analysis:\n\n';
            
            // Show all nodes
            for (let i = 0; i < element.childNodes.length; i++) {
                const node = element.childNodes[i];
                if (node.nodeType === Node.TEXT_NODE) {
                    output += `[${i}] TEXT: "${node.textContent}"\n`;
                } else if (node.nodeType === Node.ELEMENT_NODE) {
                    output += `[${i}] <${node.tagName.toLowerCase()}>: "${node.textContent}"\n`;
                    // Show child nodes
                    for (let j = 0; j < node.childNodes.length; j++) {
                        const child = node.childNodes[j];
                        if (child.nodeType === Node.TEXT_NODE) {
                            output += `  [${j}] TEXT: "${child.textContent}"\n`;
                        }
                    }
                }
            }
            
            result.textContent = output;
        }
        
        function testString() {
            const testCases = [
                '前面的文字"中间的内容"后面的文字',
                '"中间的内容"',
                '文字"',
                '"后面',
                '中间的内容'
            ];
            
            const result = document.getElementById('stringResult');
            let output = 'String Spacing Tests:\n\n';
            
            testCases.forEach(str => {
                const spaced = window.pangu.spacingText(str);
                output += `"${str}" → "${spaced}"\n`;
            });
            
            result.textContent = output;
        }
        
        // Auto-analyze on load
        window.addEventListener('DOMContentLoaded', () => {
            analyzeNodes('test1');
        });
    </script>
</body>
</html>